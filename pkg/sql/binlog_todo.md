What is left to do:
* replace query fuction with something else 
* find retry pattern, when transaction updating offset fails 
* implement binlog handler, consider if unmarshalling data shouldn't be done somewhere else (done on other branch already)
* add tests
* verify all todos left
* squash commits
* remove this file
